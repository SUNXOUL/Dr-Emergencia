@page "/V_Emergencia"
@page "/V_Emergencia/{OrdenID:int}"



@inject EmergenciaBLL emergenciaBll

<head>
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-bold-rounded/css/uicons-bold-rounded.css'>
<style>
    .Entrada{
        display: inline-block;
        padding: 5px;
        align-items: center;
    }
    .Entrada label{
        border-radius: 50px;
        background-color:#D9D9D9;
        border-color: #D9D9D9;
        border: 15px;
        margin: 5px;
    }
    .Entrada label
    {
        margin: 5px;
    }
    .Entrada textarea{
        background-color:#D9D9D9;
        border-color: #D9D9D9;
        border-radius: 15px;
        width: 100%;
    }
    .Form{
        display: block;
    }
    #Hallazgos label{
        width: 100%;
    }

</style>

</head>

<body>
    

    
    <div class="RHeader" style="z-index: -1;">
    </div>

        
    <div class="Form"  style="z-index: 1;">
    
        <div style="justify-content: space-between; display: inline-flex;; width:100%;">
        <h1>Nueva Emergencia</h1>
            <div >
    <div class="Entrada">
        <label for="fecha" >Fecha:</label>
        <label type="date" class="form-control" aria-label="Recipient's username" aria-describedby="basic-addon2" id="fecha" name="fecha"></label>
    </div>

    <div class="Entrada">
        <label for="Hora">Hora:</label>
        <label type="Hora"  id="Hora"  name="Hora"></label>
    </div>
    </div>
    </div>

    <br>
    <div class="Entrada">
        <label for="M_Consulta" >Motivo de Consulta:</label>
        <label @bind="emergencia.M_Consulta"type="M_Consulta"  id="M_Consulta"   name="M_Consulta"></label>
    </div>

    <div class="Entrada">
        <label for="A_Relacionados" >Antecedentes Relacionados:</label>
        <label type="A_Relacionados"  id="A_Relacionados"   name="A_Relacionados"></label>
    </div>
    <br>
    <div class="Entrada">
        <label for="A_Previas" >Atenciones Previas:</label>
        <label type="A_Previas"  id="A_Previas"   name="A_Previas"></label>
    </div>

    <div class="Entrada">
        <label for="Donde" >Donde?</label>
        <label type="Donde"  id="Donde"   name="Donde"></label>
    </div>

    <div class="Entrada">
        <label for="M_Base" >Medico Base:</label>
        <label type="M_Base"  id="M_Base"   name="M_Base"></label>
    </div>

    <div class="Entrada">
        <label for="Peso" >Peso:</label>
        <label type="Peso"  id="Peso"   name="Peso"></label>
        <label for="Peso" >lbs</label>
    </div>
    <br>
    <div class="Entrada">
        <label >Signos Vitales</label>
        <label for="TA" >TA:</label>
        <label type="TA"  id="TA"   name="TA"></label>
        <label for="FC" >FC:</label>
        <label type="FC"  id="FC"   name="FC"></label>
        <label for="Temperatura" >Temperatura:</label>
        <label type="Temperatura"  id="Temperatura"   name="Temperatura"></label>
        <label for="Temperatura" >C</label>
    </div>

    <div class="Entrada" style="display: inline-block;">
        <label >Laboratorios</label>
        <label for="Hemograma" >Hemograma:</label>
        <label type="Hemograma"  id="Hemograma"   name="Hemograma"></label>
        <label for="Ex_Orina" >Ex.Orina:</label>
        <label type="Ex_Orina"  id="Ex_Orina"   name="Ex_Orina"></label>
        <label for="Glisemia" >Glisemia:</label>
        <label type="Glisemia"  id="Glisemia"   name="Glisemia"></label>
        <label for="Coprologico" >Coprologico:</label>
        <label type="Coprologico"  id="Coprologico"   name="Coprologico"></label>
    </div>
    <br>
    <div class="Entrada" style="display: flex; align-items: center;" >
        <label for="Imagenes" >Imagenes:</label>
        <label type="Imagenes"  id="Imagenes"   name="Imagenes"></label>

        <label for="Especificacion" >Especfique</label>
        <textarea type="Especificacion"  id="Especificacion"   name="Especificacion"></textarea>
    </div>
    </div>
    <div  class="Entrada" style="display: flex;">
        <label for="Diagnostico">Diagnostico</label>
        <label type="Diagnostico" id="Diagnostico" style="width: 100%;" name="Diagnostico"></label>
    </div>
        <div class="Entrada " style="display:flex;" >
        <label for="TyM" >Tratamientos y Medicamentos:</label>
        <textarea type="TyM"  id="TyM"  style="width: 100%;" name="TyM"></textarea>
    </div>
    <center>
        <button type="button" class="btn btn-primary" style="padding-left: 50px;padding-right: 50px; border-radius:50px; Background-Color:#3AB5F4; border-color:#3AB5F4; margin:10px;" @onclick ="Guardar">Registrar</button>
    </center>




</body>
@code {
    [Parameter]
    public int OrdenID{get;set;}
    public Emergencia emergencia {get; set;} = new Emergencia();

    protected override void OnInitialized(){
        if (OrdenID > 0)
        {
            this.emergencia.OrdenID = this.OrdenID;
            this.Buscar();
        }
    }


    private void Buscar()
    {
        var emergenciaEncontrada = emergenciaBll.Buscar(OrdenID);
        if(emergenciaEncontrada != null)
        {
            Console.WriteLine($"Se encontro una ocupacion con el ID{this.emergencia.OrdenID}");
            this.emergencia = emergenciaEncontrada;
            
        }
        else
        {
            Nuevo();
            Console.WriteLine("Id no existente");
        }
    }


    public void Nuevo(){
        this.emergencia = new Emergencia();
    }

    public void Guardar(){

        emergenciaBll.Guardar(this.emergencia);
        Console.WriteLine($"Se guardo en el {this.emergencia.OrdenID}");
        this.Nuevo();
        
        
        //Console.WriteLine("Campos no validos o no completados");
    }
    



    public void eliminar(){

    bool RES = emergenciaBll.Eliminar(this.emergencia);

    if(RES == false){
        Console.WriteLine("Eliminado Correctamente");
        Nuevo();
    }
    else{
        Console.WriteLine("No se borro nada");
    }
            
            

        
    }
    

}
